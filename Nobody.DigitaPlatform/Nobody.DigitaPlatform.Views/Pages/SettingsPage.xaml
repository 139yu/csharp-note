<UserControl x:Class="Nobody.DigitaPlatform.Views.Pages.SettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:Nobody.DigitaPlatform.Views.Pages"
             xmlns:sys="clr-namespace:System;assembly=System.Runtime"
             xmlns:converter="clr-namespace:Nobody.DigitaPlatform.Common.Converter;assembly=Nobody.DigitaPlatform.Common"
             mc:Ignorable="d"
             FontSize="12"

             Foreground="#444"
             DataContext="{Binding Source={StaticResource Locator},Path=SettingViewModel}"
             d:DesignHeight="600" d:DesignWidth="1000">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary
                    Source="pack://application:,,,/Nobody.DigitaPlatform.Assets;component/Styles/ButtonStyle.xaml" />
                <ResourceDictionary
                    Source="pack://application:,,,/Nobody.DigitaPlatform.Assets;component/Styles/ComboxStyle.xaml" />
                <ResourceDictionary
                    Source="pack://application:,,,/Nobody.DigitaPlatform.Assets;component/Styles/DataGridStyle.xaml" />
                <ResourceDictionary>
                    <converter:RowNumberConverter x:Key="rnc" />
                </ResourceDictionary>
            </ResourceDictionary.MergedDictionaries>
            <Style TargetType="TabControl">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabControl">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="130" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Border Background="White" CornerRadius="5" Margin="5" />
                                <TabPanel x:Name="HeaderPanel" Grid.Row="0" Panel.ZIndex="1"
                                          Margin="5" IsItemsHost="True"
                                          KeyboardNavigation.TabIndex="1"
                                          Background="Transparent" />
                                <Border x:Name="Border" Grid.Column="1">
                                    <ContentPresenter x:Name="PART_SelectedContentHost" Margin="4"
                                                      ContentSource="SelectedContent" />
                                </Border>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style TargetType="TabItem">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <Border x:Name="Border" CornerRadius="5" Margin="2"
                                    Background="Transparent">
                                <ContentPresenter x:Name="ContentSite" RecognizesAccessKey="True" Margin="12,6"
                                                  VerticalAlignment="Center" HorizontalAlignment="Center"
                                                  ContentSource="Header" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="#1000" />
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" TargetName="Border" Value="#99409EFE" />
                                    <Setter Property="TextBlock.Foreground" TargetName="Border" Value="#fff" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style TargetType="TextBox">
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TextBox">

                            <Border Name="bd" BorderThickness="1" MinHeight="26" Background="#fff" BorderBrush="#1eee"
                                    CornerRadius="2">
                                <ScrollViewer Name="PART_ContentHost" Margin="5,0"
                                              VerticalScrollBarVisibility="Hidden"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                                </ScrollViewer>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsKeyboardFocused" Value="True">
                                    <Setter TargetName="bd" Property="BorderBrush" Value="#16a1ff"></Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="40" />
            <RowDefinition />
            <RowDefinition Height="80" />
        </Grid.RowDefinitions>
        <Border Height="15" Width="3" CornerRadius="2" HorizontalAlignment="Left" Background="Gold" />
        <TextBlock FontWeight="Normal" FontSize="18" VerticalAlignment="Center" HorizontalAlignment="Left"
                   Margin="5,0,0,0"
                   Text="实时报警状态" Foreground="#AA409EFE" />
        <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right">
            <Button Style="{StaticResource InfoButton}" Width="80" Margin="0,0,10,0" Content="刷新" />
            <Button Style="{StaticResource WarringButton}" Margin="0,0,10,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock VerticalAlignment="Center" Margin="0,0,5,0"
                               FontFamily="{StaticResource Iconfont}"
                               Text="&#xe60e;" />
                    <TextBlock Text="导入配置" />
                </StackPanel>
            </Button>
            <Button Style="{StaticResource PrimaryButton}" Width="120" Margin="0,0,10,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock VerticalAlignment="Center" Margin="0,0,5,0"
                               FontFamily="{StaticResource Iconfont}"
                               Text="&#xe60e;" />
                    <TextBlock Text="导出配置" />
                </StackPanel>
            </Button>
        </StackPanel>
        <TabControl Grid.Row="1" TabStripPlacement="Left">
            <TabItem Header="常规配置">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0.3*" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="0.3*" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="1" Margin="0,20,0,0">
                        <TextBlock Text="系统名称" FontSize="14" />
                        <TextBlock Text="修改应用系统主窗口中的显示名称" Margin="0,10" FontSize="12" Foreground="#999" />
                        <TextBox Text="{Binding SystemName}" />
                        <Border Margin="-10,20" BorderThickness="0,0,0,1" Height="1" BorderBrush="#eccc" />

                        <TextBlock Text="数据缓存" FontSize="14" />
                        <TextBlock Text="设置系统本地数据库文件的最大储存大小" Margin="0,10" FontSize="12" Foreground="#999" />
                        <StackPanel Orientation="Horizontal">
                            <TextBox Text="{Binding MaxBufferSize}" Width="300" />
                            <TextBlock VerticalAlignment="Center" Margin="10,0,0,0" Text="Gb" />
                        </StackPanel>
                        <Border Margin="-10,20" BorderThickness="0,0,0,1" Height="1" BorderBrush="#eccc" />

                        <TextBlock Text="日志缓存" FontSize="14" />
                        <TextBlock Text="设置系统本地日志文件的最大储存大小" Margin="0,10" FontSize="12" Foreground="#999" />
                        <StackPanel Orientation="Horizontal">
                            <TextBox Text="{Binding MaxLogBufferSize}" Width="300" />
                            <TextBlock VerticalAlignment="Center" Margin="10,0,0,0" Text="Gb" />
                        </StackPanel>
                        <TextBlock Margin="0,20,0,0" Text="日志目录" FontSize="14" />
                        <TextBlock Text="设置系统本地日志文件的储存目录" Margin="0,10" FontSize="12" Foreground="#999" />
                        <TextBox Text="{Binding LogPath}" />
                        <Border Margin="-10,20" BorderThickness="0,0,0,1" Height="1" BorderBrush="#eccc" />
                    </StackPanel>
                </Grid>
            </TabItem>
            <TabItem Header="监测配置">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0.3*" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="0.3*" />
                    </Grid.ColumnDefinitions>
                    <ItemsControl Grid.Column="1" ItemsSource="{Binding MonitorList}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Margin="0,0,0,15" FontSize="14" Text="{Binding Header}" />
                                    <TextBlock Margin="0,0,0,15" FontSize="12" Foreground="#999" Text="{Binding Desc}" />
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Foreground="#999" Text="选择设备" Margin="0,0,5,0"
                                                   VerticalAlignment="Center" />
                                        <ComboBox Name="devices" Width="200" MinHeight="25"
                                                  Style="{StaticResource PropSelectorStyle}" DisplayMemberPath="Header"
                                                  SelectedValuePath="DeviceNum" SelectedValue="{Binding DeviceNum}"
                                                  ItemsSource="{Binding DeviceList}" />
                                        <TextBlock Foreground="#999" Text="选择变量" Margin="0,0,5,0"
                                                   VerticalAlignment="Center" />
                                        <ComboBox Width="200" MinHeight="25" Style="{StaticResource PropSelectorStyle}"
                                                  DisplayMemberPath="VarName" SelectedValuePath="VarNum"
                                                  SelectedValue="{Binding VariableNum}"
                                                  ItemsSource="{Binding ElementName=devices,Path=SelectedItem.DeviceVariables}" />
                                    </StackPanel>
                                    <Border Height="1" Background="#ccc" Margin="-5,15"></Border>
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </TabItem>
            <TabItem Header="用户管理">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="50" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0.3*" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="0.3*" />
                    </Grid.ColumnDefinitions>
                    <TextBlock FontSize="14" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left"
                               Text="系统用户注册" />
                    <Button Grid.Column="1" VerticalAlignment="Center" Command="{Binding AddUserCommand}"
                            HorizontalAlignment="Right"
                            Style="{StaticResource NormalButton}">
                        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                            <TextBlock Text="&#xe607;" Margin="0,0,5,0" VerticalAlignment="Center"
                                       FontFamily="{StaticResource Iconfont}" />
                            <TextBlock Text="添加新用户" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <Border Grid.Column="1" Height="1" Margin="-10,0" Background="#cccc" VerticalAlignment="Bottom" />
                    <Grid Grid.Column="1" Grid.Row="1" Margin="0,5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0" BorderThickness="0,0,0,1" BorderBrush="#eee" Background="#22409EFE" TextBlock.Foreground="#888" CornerRadius="5">
                            <Grid Background="Transparent">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="40" />
                                    <ColumnDefinition Width="120" />
                                    <ColumnDefinition Width="120" />
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="1*" />
                                </Grid.ColumnDefinitions>
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="0"
                                           Text="序号" />
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="1"
                                           Text="用户ID" />
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="2"
                                           Text="真实姓名" />
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="3"
                                           Text="用户类型" />
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="4"
                                           Text="性别" />
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="5"
                                           Text="操作" />
                            </Grid>
                        </Border>

                        <ItemsControl Grid.Row="1" AlternationCount="1000" ItemsSource="{Binding UserList}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#fff" CornerRadius="2" BorderBrush="#eee"
                                            BorderThickness="0,0,0,1">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="40" />
                                                <ColumnDefinition Width="120" />
                                                <ColumnDefinition Width="120" />
                                                <ColumnDefinition Width="1*" />
                                                <ColumnDefinition Width="1*" />
                                                <ColumnDefinition Width="1*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center"
                                                       Text="{Binding RelativeSource={RelativeSource AncestorType=ContentPresenter},
        Path=(ItemsControl.AlternationIndex),
        Converter={StaticResource rnc},
        StringFormat={}{0:00}}">
                                            </TextBlock>
                                            <TextBox VerticalAlignment="Center"
                                                     Grid.Column="1" Text="{Binding Username }" />
                                            <TextBox VerticalAlignment="Center"  HorizontalContentAlignment="Center"
                                                     Grid.Column="2" Text="{Binding RealName }" />
                                            <ComboBox Style="{StaticResource PropSelectorStyle}" Grid.Column="3"
                                                      SelectedValue="{Binding UserType}"
                                                      SelectedValuePath="TypeId" DisplayMemberPath="TypeName"
                                                      ItemsSource="{Binding DataContext.UserTypeList, 
                                                RelativeSource={RelativeSource AncestorType=UserControl}}">
                                            </ComboBox>
                                            <ComboBox Style="{StaticResource PropSelectorStyle}" Grid.Column="4"
                                                      SelectedValue="{Binding DisplayGender}"
                                                      SelectedIndex="0">
                                                <ComboBox.ItemsSource>
                                                    <x:Array Type="sys:String">
                                                        <sys:String>男</sys:String>
                                                        <sys:String>女</sys:String>
                                                    </x:Array>
                                                </ComboBox.ItemsSource>
                                            </ComboBox>
                                            <TextBlock Grid.Column="5" VerticalAlignment="Center"
                                                       HorizontalAlignment="Center">
                                                <Hyperlink TextDecorations="None"
                                                           CommandParameter="{Binding}"
                                                           Command="{Binding DataContext.ResetPasswordCommand, 
                                                    RelativeSource={RelativeSource AncestorType=ItemsControl}}">
                                                    重置密码
                                                </Hyperlink>
                                                <Hyperlink TextDecorations="None" CommandParameter="{Binding}"
                                                           Command="{Binding DataContext.RemoveUserCommand, 
RelativeSource={RelativeSource AncestorType=ItemsControl}}">
                                                    删除
                                                </Hyperlink>
                                            </TextBlock>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>
        <Button Grid.Row="2" Margin="0,0,50,0" Command="{Binding SaveSettingCommand}" VerticalAlignment="Center" HorizontalAlignment="Right" Style="{StaticResource PrimaryButton}">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Top">
                <TextBlock VerticalAlignment="Center" Margin="0,0,5,0"
                           FontFamily="{StaticResource Iconfont}"
                           Text="&#xec09;" />
                <TextBlock Text="保存" />
            </StackPanel>
        </Button>
    </Grid>
</UserControl>